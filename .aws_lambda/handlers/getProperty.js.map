{
  "version": 3,
  "sources": ["../../src/handlers/getProperty.ts", "../../src/db/connection.ts", "../../src/db/models/properties.ts"],
  "sourcesContent": ["import { connectToDb } from \"../db/connection\";\nimport { getPropertyModel } from \"../db/models/properties\";\nimport type { IProperties } from \"../db/models/properties\";\nimport type { Sequelize } from \"sequelize\";\nimport type { APIGatewayProxyEvent, APIGatewayProxyResult } from \"aws-lambda\";\n\nlet sequelize: Sequelize | null = null;\nlet Properties: IProperties | null = null;\n\nexport default async (event: APIGatewayProxyEvent): Promise<APIGatewayProxyResult> => {\n  if (!sequelize) {\n    sequelize = await connectToDb();\n    Properties = await getPropertyModel(sequelize);\n  }\n  const foundProperty = await Properties.findByPk(event.pathParameters.id);\n\n  return {\n    statusCode: 200,\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(foundProperty.toJSON()),\n  };\n};\n", "import { Sequelize } from \"sequelize\";\n\nconst { TIMEOUT, DB_HOST, DB_NAME, DB_USER, DB_PASSWORD } = process.env;\nconst timeout = Number(TIMEOUT) * 1000;\nconst URI = `postgres://${DB_USER}:${DB_PASSWORD}@${DB_HOST}/${DB_NAME}`;\n\nlet sequelize: Sequelize | null = null;\n\n// https://sequelize.org/docs/v6/other-topics/aws-lambda/#tldr\nexport const connectToDb = async (): Promise<Sequelize> => {\n  if (sequelize) {\n    sequelize.connectionManager.initPools();\n\n    if (sequelize.connectionManager.hasOwnProperty(\"getConnection\")) {\n      delete sequelize.connectionManager.getConnection;\n    }\n    return sequelize;\n  }\n\n  sequelize = new Sequelize(URI, {\n    logging: false,\n    pool: {\n      min: 0,\n      max: 2,\n      idle: 0,\n      acquire: 3000,\n      evict: timeout,\n    },\n  });\n  await sequelize.authenticate();\n\n  return sequelize;\n};\n", "import { Sequelize, Model, DataTypes } from \"sequelize\";\nimport type { ModelAttributes } from \"sequelize\";\nclass Properties extends Model {}\n\nconst schema: ModelAttributes = {\n  id: {\n    primaryKey: true,\n    type: DataTypes.INTEGER,\n    autoIncrement: true,\n  },\n  name: {\n    type: DataTypes.STRING,\n    allowNull: false,\n  },\n  address: {\n    type: DataTypes.STRING,\n    allowNull: false,\n  },\n  imgUrl: {\n    type: DataTypes.STRING,\n    allowNull: false,\n  },\n};\n\ntype IProperties = typeof Properties;\nexport const getPropertyModel = async (sequelize?: Sequelize): Promise<IProperties> => {\n  if (sequelize) {\n    Properties.init(schema, { sequelize, modelName: \"properties\", timestamps: false });\n    await Properties.sync();\n  }\n\n  return Properties;\n};\n\nexport type { IProperties };\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA,uBAA0B;AAE1B,IAAM,EAAE,SAAS,SAAS,SAAS,SAAS,YAAY,IAAI,QAAQ;AACpE,IAAM,UAAU,OAAO,OAAO,IAAI;AAClC,IAAM,MAAM,cAAc,OAAO,IAAI,WAAW,IAAI,OAAO,IAAI,OAAO;AAEtE,IAAI,YAA8B;AAG3B,IAAM,cAAc,YAAgC;AACzD,MAAI,WAAW;AACb,cAAU,kBAAkB,UAAU;AAEtC,QAAI,UAAU,kBAAkB,eAAe,eAAe,GAAG;AAC/D,aAAO,UAAU,kBAAkB;AAAA,IACrC;AACA,WAAO;AAAA,EACT;AAEA,cAAY,IAAI,2BAAU,KAAK;AAAA,IAC7B,SAAS;AAAA,IACT,MAAM;AAAA,MACJ,KAAK;AAAA,MACL,KAAK;AAAA,MACL,MAAM;AAAA,MACN,SAAS;AAAA,MACT,OAAO;AAAA,IACT;AAAA,EACF,CAAC;AACD,QAAM,UAAU,aAAa;AAE7B,SAAO;AACT;;;AChCA,IAAAA,oBAA4C;AAE5C,IAAM,aAAN,cAAyB,wBAAM;AAAC;AAEhC,IAAM,SAA0B;AAAA,EAC9B,IAAI;AAAA,IACF,YAAY;AAAA,IACZ,MAAM,4BAAU;AAAA,IAChB,eAAe;AAAA,EACjB;AAAA,EACA,MAAM;AAAA,IACJ,MAAM,4BAAU;AAAA,IAChB,WAAW;AAAA,EACb;AAAA,EACA,SAAS;AAAA,IACP,MAAM,4BAAU;AAAA,IAChB,WAAW;AAAA,EACb;AAAA,EACA,QAAQ;AAAA,IACN,MAAM,4BAAU;AAAA,IAChB,WAAW;AAAA,EACb;AACF;AAGO,IAAM,mBAAmB,OAAOC,eAAgD;AACrF,MAAIA,YAAW;AACb,eAAW,KAAK,QAAQ,EAAE,WAAAA,YAAW,WAAW,cAAc,YAAY,MAAM,CAAC;AACjF,UAAM,WAAW,KAAK;AAAA,EACxB;AAEA,SAAO;AACT;;;AF1BA,IAAIC,aAA8B;AAClC,IAAIC,cAAiC;AAErC,IAAO,sBAAQ,OAAO,UAAgE;AACpF,MAAI,CAACD,YAAW;AACd,IAAAA,aAAY,MAAM,YAAY;AAC9B,IAAAC,cAAa,MAAM,iBAAiBD,UAAS;AAAA,EAC/C;AACA,QAAM,gBAAgB,MAAMC,YAAW,SAAS,MAAM,eAAe,EAAE;AAEvE,SAAO;AAAA,IACL,YAAY;AAAA,IACZ,SAAS;AAAA,MACP,gBAAgB;AAAA,IAClB;AAAA,IACA,MAAM,KAAK,UAAU,cAAc,OAAO,CAAC;AAAA,EAC7C;AACF;",
  "names": ["import_sequelize", "sequelize", "sequelize", "Properties"]
}
